version: 2.1

reusejobs: &reusejobs
  - build
  - build2:
      requires:
        - build

executors:
  default:
    docker:
      - image: circleci/python

jobs:
  build:
    executor: default
    steps:
      - run: |
          set -x
          curl -H "Authorization: token ${GITHUB_TOKEN} \
            -d '{"state": "error","target_url": "https://example.com","description": "The test worked!","context": "continuous-integration/CircleCI-Test"}' \
            https://api.github.com/repos/fernfernfern/circleciapp/statuses/${CIRCLE_SHA1}
      - run: sleep 10 
  build2:
    executor: default
    steps:
      - run: sleep 10 

workflows:
  example:
    jobs:
      *reusejobs
  nightly:
    jobs:
      *reusejobs
    triggers:
      - schedule:
          cron: "0 0 * * *"
          filters:
            branches:
              only:
                - master


